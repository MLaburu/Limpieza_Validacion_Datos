---
title: 'PrÃ¡ctica 2: Limpieza y validaciÃ³n de los datos'
author: "Autores: Mikel Laburu Haro, Unai Mateos Corral"
date: "Curso 2018/2019"
output:
  pdf_document:
    highlight: zenburn
    toc: yes
  word_document: default
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 3
    includes:
      in_header: Cabecera.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval=T, echo=T)
```

******
# Introducción

## Descripción
## Objetivos
## Competencias
******

# Descripción del dataset

Se realiza la carga del conjunto de datos, así como la selección de las variables con las que se va a trabajar. Explicar por qué estas, y hacer una descripcion del dataset.

```{r message= FALSE, warning=FALSE}
#Cargamos el Dataset
myData <- read.csv("BlackFriday.csv", header = TRUE, sep = ",")
# Mostrar las primeras 10 lineas del dataset y el contenido de 9 variables
head(myData[,1:9],10)
# Tipo de los datos de cada variable
sapply(myData,class)
```

# Integración y selección de los datos de interés a analizar

```{r message= FALSE, warning=FALSE}
myDataAux <- myData[,c("Gender","Age","Occupation","City_Category","Stay_In_Current_City_Years",
                       "Marital_Status","Product_Category_1","Product_Category_2","Product_Category_3",
                       "Purchase")]
```

# Limpieza de los datos
## Eliminación de ceros, vacios y nulos

```{r message= FALSE, warning=FALSE}
colSums(is.na(myDataAux))
colSums(myDataAux == "?")
colSums(myDataAux == "")
myDataAux$Product_Category_2[is.na(myDataAux$Product_Category_2)] <- 0
myDataAux$Product_Category_3[is.na(myDataAux$Product_Category_3)] <- 0
str(myDataAux)
myDataAux$Marital_Status <- as.factor(myDataAux$Marital_Status)
myDataAux$Occupation <- as.factor(myDataAux$Occupation)
myDataAux$Product_Category_1 <- as.factor(myDataAux$Product_Category_1)
myDataAux$Product_Category_2 <- as.factor(myDataAux$Product_Category_2)
myDataAux$Product_Category_3 <- as.factor(myDataAux$Product_Category_3)
str(myDataAux)
```

## Identificación y tratamiento de valores extremos

```{r message= FALSE, warning=FALSE}
#Comentario
boxplot(myDataAux$Purchase)
valoresAtiPurch <- boxplot.stats(myDataAux$Purchase)$out
length(valoresAtiPurch)
valoresAtiPurch[0:69]
```

# Análisis de los datos
## Selección de los grupos de datos a analizar

```{r message= FALSE, warning=FALSE}
# Agrupación en funcion del estado civil
myDataAux.solteros <- myDataAux[myDataAux$Marital_Status == 0,]
myDataAux.casados <- myDataAux[myDataAux$Marital_Status == 1,]

# Agrupación en funcion de la categoría de la ciudad
myDataAux.ciudadA <- myDataAux[myDataAux$City_Category == "A",]
myDataAux.ciudadB <- myDataAux[myDataAux$City_Category == "B",]
myDataAux.ciudadC <- myDataAux[myDataAux$City_Category == "C",]

# Agrupación en funcion del genero
myDataAux.hombres <- myDataAux[myDataAux$Gender == "M",]
myDataAux.mujeres <- myDataAux[myDataAux$Gender == "F",]

# Agrupación en funcion de la categoría de la edad
myDataAux.edad1 <- myDataAux[myDataAux$Age == "0-17",]
myDataAux.edad2 <- myDataAux[myDataAux$Age == "18-25",]
myDataAux.edad3 <- myDataAux[myDataAux$Age == "26-35",]
myDataAux.edad4 <- myDataAux[myDataAux$Age == "36-45",]
myDataAux.edad5 <- myDataAux[myDataAux$Age == "46-50",]
myDataAux.edad6 <- myDataAux[myDataAux$Age == "51-55",]
myDataAux.edad7 <- myDataAux[myDataAux$Age == "55+",]

```

## Comprobación de la normalidad y homogeneidad de la varianza

La normalidad ha de calcularse solo con las variables numéricas, teniendo en nuestro caso simplemente el campo "Purchase", puesto que aunque el resto de variables también lo puedan paracer se tratan de variables discretas cuyos valores representan una categoría o estado.Dicho esto, porcedemos a calcular la normalidad empleando la técnica de Anderson-Darlinng, con la que habrá que comparar el p-valor obtenido por la aplicación de esta técnica con un porcentaje de significación del 5%, $\alpha=0,05$, teniendo que ser el p-valor obtenido menor que $\alpha$ para que esta variable sea normal. Aunque existen diferentes test para determinar si un conjunto de datos sigue una distribución normal, se ha optado por el test comentado debido a que es el más adecuado cuando el dataset esta constituido por un gran número de instancias.

```{r message= FALSE, warning=FALSE}
# Normalidad

library(nortest)
ad.test(myDataAux$Purchase)

```

Tras lograr el p-valor correspondiente a la variable no categórica "Purchase", se puede determinar que no sigue una distribución normal, puesto que su p-valor es inferior a $\alpha=0,05$.


La homogeneidad será calculada entre mútiples pares de atributos, el primero de ellos formado por los atributos que representan el gasto realizado junto con el estado civil de cada persona, y el segundo, por su parte, con los atributos que representan el gasto de cada persona junto con su género. Para ello, se empleará el F-test, tal y como se aprecia a continuación:
```{r message= FALSE, warning=FALSE}
# Homogeneidad
var.test(Purchase~Marital_Status, data = myDataAux)
var.test(Purchase~Gender, data = myDataAux)

```

En el caso en el que se mide la homegeniedad entre el gasto y el estado civil el p-valor obtenido es de 0.2897, siendo mucho mayor que 0.05, con lo que se considera que no hay diferencias significativcas entre las varianzas de ambos grupos. No obstante, cuando la homegeneidad es medida entre el gasto de cada persona junto con su género, el p-valor resultante es de 2.2e-16, siendo considerablemente inferior a 0.05, por lo que si hay diferencias entre las varianzas de estos dos grupos.

## Aplicación de pruebas estadísticas
A continuación se va a proceder a realizar un análisis estadístico, en el que se efecuará una prueba de correalación, un contraste de hipótesis y un regreseión lineal.



```{r message= FALSE, warning=FALSE}
#Comentario
```

```{r message= FALSE, warning=FALSE}
#Comentario
```

```{r message= FALSE, warning=FALSE}
#Comentario
```

```{r message= FALSE, warning=FALSE}
#Comentario
```

```{r message= FALSE, warning=FALSE}
#Comentario
```
